<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Vision Pro - זיהוי אובייקטים חכם</title>
    <meta name="description" content="מערכת זיהוי אובייקטים חכמה המזהה אנשים, חיות ורכבים מתוך סרטונים באמצעות בינה מלאכותית">
    <meta name="theme-color" content="#3563E9">
    
    <!-- גופנים -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- סגנונות -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/mobile.css" media="(max-width: 900px)">
    
    <!-- אייקונים -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    
    <!-- Progressive Web App -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="assets/icons/app-icon-192.png">
</head>
<body>
    <header class="site-header">
        <div class="header-shapes">
            <div class="header-shape shape-1"></div>
            <div class="header-shape shape-2"></div>
            <div class="header-shape shape-3"></div>
        </div>
        <div class="container">
            <div class="header-content">
                <h1>AI Vision Pro</h1>
                <p>מערכת זיהוי אובייקטים חכמה המזהה אנשים, חיות, רכבים ועוד ברמת דיוק גבוהה ובאיכות תמונה משופרת</p>
            </div>
        </div>
    </header>
    
    <div class="container" id="app-container">
        <!-- תוכן מועתק מקובץ app-content.html -->
    </div>
    
    <footer class="site-footer">
        <div class="container">
            <p>© AI Vision Pro | פותח באמצעות טכנולוגיות TensorFlow.js</p>
        </div>
    </footer>
    
    <!-- סקריפט לניהול טעינה ואתחול -->
    <script>
        // טעינת תוכן האפליקציה
        fetch('app-content.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('app-container').innerHTML = html;
                console.log('תוכן האפליקציה נטען');
                // בדיקה שטעינת התוכן הושלמה
                initApp();
            })
            .catch(error => {
                console.error('שגיאה בטעינת תוכן האפליקציה:', error);
                document.getElementById('app-container').innerHTML = `
                    <div style="text-align: center; margin: 50px 0;">
                        <h2>שגיאה בטעינת האפליקציה</h2>
                        <p>נא לוודא שקובץ app-content.html קיים וזמין.</p>
                        <button onclick="location.reload()" class="btn btn-primary">נסה שוב</button>
                    </div>
                `;
            });
            
        // פונקציית טעינת סקריפטים
        function loadScript(src) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = src;
                script.async = true;
                script.onload = resolve;
                script.onerror = () => reject(new Error(`Failed to load script: ${src}`));
                document.body.appendChild(script);
            });
        }
        
        // אתחול האפליקציה
        function initApp() {
            // טעינת מודולים בסיסיים
            Promise.all([
                loadScript('js/config.js'),
                loadScript('js/utils.js')
            ])
            .then(() => {
                console.log('מודולים בסיסיים נטענו');
                return loadScript('js/ui.js');
            })
            .then(() => {
                console.log('מודול UI נטען');
                
                // טעינת מודולים נוספים במקביל
                return Promise.all([
                    loadScript('js/imageProcessing.js'),
                    loadScript('js/detection.js'),
                    loadScript('js/exports.js')
                ]);
            })
            .then(() => {
                console.log('כל המודולים נטענו');
                return loadScript('js/app.js');
            })
            .then(() => {
                console.log('אפליקציה מוכנה');
                if (window.APP && typeof window.APP.init === 'function') {
                    // אתחול האפליקציה
                    window.APP.init();
                } else {
                    console.warn('APP.init לא זמין, מפעיל אתחול חלופי');
                    initDirectLogin();
                }
            })
            .catch(error => {
                console.error('שגיאה בטעינת סקריפטים:', error);
                // אפשר אתחול בסיסי גם במקרה של שגיאה
                initDirectLogin();
            });
        }
        
        // פונקציית התחברות ישירה במקרה של שגיאה בטעינת המודולים
        function initDirectLogin() {
            // אתחול מאזיני אירועים בסיסיים
            const loginButton = document.getElementById('loginButton');
            if (loginButton) {
                loginButton.addEventListener('click', handleLogin);
            }
            
            const closeNotificationBtn = document.querySelector('.notification-close');
            if (closeNotificationBtn) {
                closeNotificationBtn.addEventListener('click', function() {
                    document.getElementById('notification').classList.remove('show');
                });
            }
            
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    openTab(this.getAttribute('data-tab'));
                });
            });
            
            // בדיקה אם המשתמש כבר מחובר
            const userName = localStorage.getItem('ai_vision_pro_userName');
            if (userName) {
                document.getElementById('userName').value = userName;
                setTimeout(handleLogin, 500);
            }
        }
        
        // פתיחת לשונית
        function openTab(tabName) {
            // הסרת האקטיביות מכל הטאבים
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            tabContents.forEach(content => content.classList.remove('active'));
            
            // הפעלת הלשונית הנבחרת
            document.getElementById(tabName).classList.add('active');
            document.querySelector(`.tab[data-tab="${tabName}"]`).classList.add('active');
            
            // עדכון סליידר
            updateTabSlider();
        }
        
        function updateTabSlider() {
            const activeTab = document.querySelector('.tab.active');
            const slider = document.querySelector('.tab-slider');
            
            if (activeTab && slider && window.innerWidth > 600) {
                slider.style.width = `${activeTab.offsetWidth}px`;
                slider.style.left = `${activeTab.offsetLeft}px`;
            }
        }
        
        // פונקציית התחברות
        function handleLogin() {
            const userName = document.getElementById('userName').value;
            
            if (!userName || userName.trim() === '') {
                document.getElementById('loginStatus').textContent = "נא להזין שם משתמש";
                return;
            }
            
            document.getElementById('loginButton').disabled = true;
            document.getElementById('loginStatus').textContent = "מתחבר...";
            
            // אחסון השם בלוקל סטורג'
            localStorage.setItem('ai_vision_pro_userName', userName);
            
            // סימולציה של השגת IP
            const fakeIP = "192.168.1." + Math.floor(Math.random() * 255);
            localStorage.setItem('ai_vision_pro_userIP', fakeIP);
            
            // עדכון ממשק המשתמש
            document.getElementById('usageCount').textContent = "5";
            document.getElementById('loginStatus').textContent = '';
            document.getElementById('mainApp').style.display = 'block';
            document.getElementById('loginSection').style.display = 'none';
            
            // אנימציית כניסה
            document.getElementById('mainApp').animate([
                { opacity: 0, transform: 'translateY(20px)' },
                { opacity: 1, transform: 'translateY(0)' }
            ], {
                duration: 500,
                easing: 'ease-out',
                fill: 'forwards'
            });
            
            // הצג הודעה
            showNotification(`ברוך הבא, ${userName}!`, 'success');
        }
        
        // הצגת הודעה
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            if (!notification) return;
            
            const notificationIcon = notification.querySelector('.notification-icon');
            const notificationTitle = notification.querySelector('.notification-title');
            const notificationMessage = notification.querySelector('.notification-message');
            
            // הגדרת סוג ההתראה
            notificationIcon.className = 'notification-icon';
            
            switch(type) {
                case 'success':
                    notificationIcon.classList.add('success');
                    notificationIcon.innerHTML = '<i class="fas fa-check"></i>';
                    notificationTitle.textContent = 'הצלחה';
                    break;
                case 'error':
                    notificationIcon.classList.add('error');
                    notificationIcon.innerHTML = '<i class="fas fa-exclamation-triangle"></i>';
                    notificationTitle.textContent = 'שגיאה';
                    break;
                case 'info':
                default:
                    notificationIcon.classList.add('info');
                    notificationIcon.innerHTML = '<i class="fas fa-info"></i>';
                    notificationTitle.textContent = 'עדכון';
            }
            
            notificationMessage.textContent = message;
            
            // הצגת ההתראה עם אנימציה
            notification.classList.add('show');
            
            // הסתרה אוטומטית לאחר 5 שניות
            setTimeout(() => {
                notification.classList.remove('show');
            }, 5000);
        }
    </script>
</body>
</html>
